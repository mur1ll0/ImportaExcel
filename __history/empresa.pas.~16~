unit empresa;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Buttons;

type
  TForm3 = class(TForm)
    LabelRazao: TLabel;
    razaoSocial: TEdit;
    LabelFantasia: TLabel;
    nomeFantasia: TEdit;
    Label1: TLabel;
    cnpj: TEdit;
    Label2: TLabel;
    empr: TEdit;
    Label3: TLabel;
    inscr: TEdit;
    simples: TRadioButton;
    normal: TRadioButton;
    Label4: TLabel;
    ende: TEdit;
    Label5: TLabel;
    bair: TEdit;
    Label6: TLabel;
    cep: TEdit;
    Label7: TLabel;
    cida: TComboBox;
    Label8: TLabel;
    fone: TEdit;
    mail: TEdit;
    Label9: TLabel;
    save: TBitBtn;
    cancel: TBitBtn;
    procedure cancelClick(Sender: TObject);
    procedure saveClick(Sender: TObject);

  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form3: TForm3;

implementation


{$R *.dfm}


//Botão Cancelar (Sair) sem matar a tela, para que as informações permanecam ali
procedure TForm3.cancelClick(Sender: TObject);
begin
  Form3.Visible := False;
end;


//Botão para salvar no banco
procedure TForm3.saveClick(Sender: TObject);
begin
  try
    try
      //Abrir conexoes
      Form1.Connect.Open;
      SQL := TSQLDataSet.Create(Nil);
      SQL.SQLConnection := Connect;

      //Executar INSERT
      Form2.atualizaStatus('Inserindo dados na tabela SUB_GRUP_PROD.');
      SQL.CommandText := 'insert into sub_grup_prod ('+ colSubGrupo +') values ' + '(' + dadosSubGrupo + ');';
      SQL.ExecSQL;

    except
      on e: exception do
      begin
        ShowMessage('Erro SQL: '+e.message+sLineBreak+SQL.CommandText);
        status := 0;
        break; //Quebra o for
      end;
    end;

  finally
    SQL.Free;
    Connect.Close;
  end;
end;

end.
